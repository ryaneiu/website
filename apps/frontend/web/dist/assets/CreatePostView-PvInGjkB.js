import{h,j as e,f as m,a as i,k as v,l as g,m as b,n as j,o as w}from"./index-Dxn2WRx0.js";import{T as y}from"./TransparentIconButton-BruHbNhV.js";import{L as k}from"./LoadableButton-DlaIFtR9.js";function P({disabled:o=!1,className:t,...r}){const a=h("transition-colors px-2 py-2 w-[90vw] sm:w-[80vw] md:w-[60vw] lg:w-[40vw] h-[60vh] rounded-md border border-black/15 focus:outline-none focus:border-black/35",o?"cursor-not-allowed opacity-50":"",t);return e.jsx("textarea",{disabled:o,className:a,...r})}function N({disabled:o=!1,className:t,...r}){const a=h("transition-colors border p-2 rounded-md focus:outline-none focus:border-black/35",o?"cursor-not-allowed opacity-50":"",t);return e.jsx("input",{className:a,disabled:o,...r})}async function T(o){try{const t=await o.json();return t.detail?t.detail:null}catch(t){return console.warn("Failed to extract details: ",t),null}}function A(){const o=m(),[t,r]=i.useState(""),[a,c]=i.useState(""),[n,d]=i.useState(!1),p=()=>{o("/")},f=async()=>{if(!t&&!a){alert("Please enter a title or content");return}d(!0);try{console.log("Title: ",t," content: ",a);const s=await g();if(!s)throw new Error("No access token");const l=await fetch(`${b}/api/posts/`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({title:t,content:a})});if(!l.ok){const u=await T(l);throw u?new Error(u):new Error("Failed to create post: "+l.statusText)}const x=await l.json();console.log("Post created:",x),j("Post created!"),r(""),c(""),o("/")}catch(s){console.error(s),w("Error while creating post: "+s),w("note: not implemented. Unable to create post from the client because no appropriate post creation & publish endpoints are exposed and usable.")}finally{d(!1)}};return e.jsx(v,{className:"w-full h-[100vh] flex justify-center items-center",children:e.jsxs("div",{className:"flex flex-col gap-3 border border-black/15 px-4 py-2 items-center relative rounded-md bg-white shadow-lg",children:[e.jsx("div",{className:"absolute top-0 right-0 m-1",children:e.jsx(y,{onClick:p,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#1f1f1f",children:e.jsx("path",{d:"m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"})})})}),e.jsx("h1",{className:"text-3xl font-bold text-black",children:"Create Post"}),e.jsx(N,{className:"w-[90vw] sm:w-[80vw] md:w-[60vw] lg:w-[40vw]",placeholder:"Title",value:t,onChange:s=>r(s.target.value),disabled:n}),e.jsx(P,{className:"px-2 py-2 w-[90vw] sm:w-[80vw] md:w-[60vw] lg:w-[40vw] h-[60vh] rounded-md border border-black/15 focus:outline-none focus:border-black/35",placeholder:"Your random thoughts...",value:a,onChange:s=>c(s.target.value),disabled:n}),e.jsx("div",{children:e.jsx(k,{text:n?"Publishing...":"Publish Post",isPrimary:!0,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#fff",children:e.jsx("path",{d:"M120-160v-640l760 320-760 320Zm80-120 474-200-474-200v140l240 60-240 60v140Zm0 0v-400 400Z"})}),iconAtRight:!0,onClick:f,isLoading:n,isWhiteSpinner:!0})})]})})}export{A as default};
